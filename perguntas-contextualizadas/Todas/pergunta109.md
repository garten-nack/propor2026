**Pergunta 109**: O que é a função softmax?

**Segmentos recuperados pelo E5**:
- *Corpus ID:* 7740
- *Score:* 0.8558039665222168
- *URL:* oculto
- *Início:* 00:18:26
- *Fim:* 00:21:16
- *Transcrição:* viu desde a primeira lá né então voltando lá no lenet né Eh bom eu não vou voltar ao slide mas a última camada como é que era era uma camada densa que gerava 10 neurônios com ativação soft Max certo tá aqui ela tá então vamos focar exatamente na última linha aqui então o que que a rede efetivamente tá produzindo tá produzindo um conjunto de 10 valores tá e a ativação usada nesse cara é um softmax não vou entrar em detalhes sobre a formulação da softmax Mas que que a função softmax gera ela gera basicamente um conjunto de valores entre 0 e 1 mais do que isso de tal maneira que a soma desses valores dê sempre igual a 1 tá Por que que esse tipo de ativação ela é interessante para um problema de classificação el ela vai indicar a probabilidade relacionada a cada saída exatamente tá então A ideia é enxergar a a softmax como sendo uma probabilidade tá então uma função de probabilidade ela tem soma um então a ideia da softmax é gerar algo que pareça uma função de probabilidade n então Eh via de regra eu pego o neurônio que tem a maior ativação como sendo a categoria A vencedora Tá mas eu também posso olhar o o valor desse cara para ter uma noção da confiança né tipo ah se o valor se eu tenho 10 valores o maior deu 0.2 e o resto tudo deu 0.1 12 a confiança não é tão grande tá Tá mas a a moral é exatamente tentar entender a a função de ativação com a natureza dos dados que eu quero produzir tá então eh basicamente a a camada final final mesmo é essa tá mas existe uma camada anterior que é uma camada fully connected tá que bas basicamente ela gera 84 neurônios intermediários antes dos 10 de saída tá se eu voltar um pouquinho atrás e olhar a vgg olhar

- *Corpus ID:* 4491
- *Score:* 0.8525283336639404
- *URL:* oculto
- *Início:* 01:12:54
- *Fim:* 01:15:28
- *Transcrição:* por ser um soft Max tá a gente consegue saber o soft Max tem lá uma derivada tem um jeito de calcular né esse triangulinho para baixo significa Gradiente tá triangulinho para baixo aqui Gradiente ou seja n para que lado ou seja somar ou diminuir aumentar ou diminuir aumentar ou diminuir o teta para melhorar para aumentar aumentar a política ou diminuir né aumentar ou diminuir e nesse caso aqui nesse caso aqui com esse gráfico tá vamos supor que seja dessa forma aqui né o o o gráfico da probabilidade de escolher ação de acordo com o parâmetro nesse caso aqui né vamos supor que o parametro Zinho teta tenha esse valor aqui tá qualquer número que que a gente queira botar aqui sei lá número cinco tá então essa ação né o a o Tazinho lá é C E aí na hora a gente usa o teta para calcular o h e o h dá a probabilidade lá né então aqui já tá direto né a probabilidade é em função do H né do teta né nesse caso aqui é C E aí a gente qualquer se a gente mudar o numerozinho aqui vai mudar na saída lá e o que essa função tá dizendo né é como que eu devo mudar o h se eu para aumentar ou diminuir a política e nesse caso aqui nesse caso aqui se eu aumentar o teta a chance de escolher aquela ação vai aumentar ou diminuir diminuir diminuir diminuir beleza então né Eh a derivada né o gradiente nos dá essa informação Beleza então se eu aumentar aqui o teta nesse caso aqui ó se aumentar o teta então a probabilidade de a diminui deixa eu ver se aí um texto ali uma pergunta então a vantagem de soft Max é essa de encontrar o ponto da derivada é uma das vantagens tá o soft Max é diferenciável né uma função que tem derivada então e para para fins de

- *Corpus ID:* 3060
- *Score:* 0.8484640121459961
- *URL:* oculto
- *Início:* 00:12:09
- *Fim:* 00:14:35
- *Transcrição:* aqui né na na cada neurônio se exigmoide então o que acontece é que usa se usa uma função de ativação meio que incomum aqui que ela pega as os valores né que de potencial de ativação e normaliza as saídas de forma que a soma aqui probabilidade de gato mais cachorro mais gorila de 100% né a função que faz isso é a soft Max então quando a gente usar alguma biblioteca de rede neural tiver ativação soft Max É Para Isso é para um problema de classificação com múltiplas classes né então o y aqui vai ser sei lá classe 0 é gato a classe 1 é cachorro a classe 2 é Gorila e cada ponto de dados cada a mostra né Cada imagem aqui com npixels xn vai ter o seu sua saída respectiva aqui E aí o softmax faz isso né Ele é como se fosse tem características de sigmoide Porque continua sendo probabilidade mas agora todas as probabilidades vão somar para um né Isso é bastante desejado então supondo né que os valores possíveis que fossem fazer isso as 70% acha que é gato 20% Gorila e aliás 20% do cachorro 10% do gorila a soma disso meu somatório aqui das probabilidades da eu somatório das probabilidades aqui na camada de sair tá então tem como né a gente fazer né um problema pegar um problema de múltiplas classes e tem existe né uma função de ativação que generaliza a sigmóide para múltiplas saídas é o nome dela é soft Max tá então ficou uma pequena antecipação aqui né do que que a gente vai ver em algum momento futuro Ok alguma dúvida eu abrir nesse parênteses mas agora eu vou continuar né a nossa digamos revisão aqui da aula anterior né então a passagem para frente aqui né forever do nosso da nossa rede neural é o nome matemática dela né Multilaser porque tem múltiplas camadas né múltiplas camadas de percepção cada unidade aqui é um perceptro então isso aqui é um percentum outro perceptro um

- *Corpus ID:* 4473
- *Score:* 0.8462872505187988
- *URL:* oculto
- *Início:* 00:39:03
- *Fim:* 00:41:17
- *Transcrição:* esse vetor inteiro aqui de oito ã casinhas aqui ação de pra direita tem seus outros números ã e assim por diante né ação de e para baixo enfim vamos ver o que que vai que que vai dar aqui e aí agora em vez de calcular o valor eu calculo a preferência e o cálculo é o mesmo tá é é o produto interno aqui esse vezes esse esse vezes esse mas o a questão agora é que o número que vai sair aqui ao final né não tem nenhuma eh nenhum compromisso de ser uma Estimativa de Recompensa é só a preferência do agente E aí dadas as preferências eu vou usar um soft Max em cima dessas preferências Isso é muito bom né usar o soft Max porque ele me dá uma distribuição de probabilidades lembram lá né no em classificação de imagens ou qualquer problema de classificação né em redes neurais a gente usava um soft Max na saída se elá tinha 10 as imagens possíveis lá o cfar 10 por exemplo ou emist que seja o soft Max ele dá uma probabilidade né sei lá se 90% de chance ele acha que é o número zero é 5% de chance ele acha que é o número 9 sei lá mais outro 5% de chance ele acha que é outro número no somatório aqui dá 100% né Ou seja eu posso posso jogar um sortear um Random aqui que alguma das coisas né vai vai ser escolhida pelo algoritmo aqui é a mesma coisa tá o soft Max para obter a política né então no caso aqui são quatro ações né A gente vai ver como é que vai ser esses valores aqui soft Max ã antes né de usar o soft Max eu tenho que calcular a preferência digamos o potencial ali né de escolher cada ação aí eu chamo de H tá tem o nome usando o o nome do livro de aprendizado por reforço ele chama de H essa preferência e é o produto interno então pega esse vetor do estado e multiplica né pelo vetor das ações para cada uma das ações né então eu vou ter um h aqui outro aqui outro e outro vou ter quatro h e depois vou fazer o soft Max em cima deles então

- *Corpus ID:* 7756
- *Score:* 0.8460937738418579
- *URL:* oculto
- *Início:* 00:49:17
- *Fim:* 00:51:52
- *Transcrição:* geral a gente não usa o soft Max para como ativação para esse tipo de problema por quê Porque se uma categoria tá fortemente ativada próxima de um por consequência todas demais T que estar próximas de zero e eu gostaria idealmente se eu tenho uma imagem que tem gato e galinha né simultaneamente na imagem que a minha rede desce valores próximos de um tanto para gato quanto paraa galinha e o softmex impede isso faz sentido então o que que eu Qual é a estratégia usual eu vou usar uma saída sigmoide né eu vou usar uma categoria sigmoide então cada valor cada categoria gera valores entre zer e 1 mas eu não não tenho uma restrição da soma delas da um potencialmente todas podem dar zero e todas ou todas podem dar um certo tá então se eu tenho um dado de anotação do tipo One hot encoding com um nas categorias desejadas e zero nas demais tá é bom aqui tá só a a comentário que softmax não é adequado Que tipo de L Eu poderia usar aí gente bom eu posso usar uma binary cross entrop para cada categoria Então na verdade eu encaro esse problema como sendo um problema binário para cada uma das categorias individuais tá então basicamente a minha L vai ser um somatório das binary Cross entropies considerando todas as categorias possíveis tá então eu vou avaliar cada categoria olha categoria pessoa tem pessoa ali tá então Digamos que a pessoa seja o índice igual a 1 se não tem pessoa numa imagem o y I vai dar igual a zero se o y e deu igual a zero pelo que a gente já viu da binary Cross entropy essa loss força com que o y chapéu I que é o score associado à categoria pessoa dê próxima de Zero Isso é feito de maneira independente para cada categoria tá então se nenhuma categoria tá presente numa determinada imagem a lz Vai forçar para que todas predições dê próximas de zero tá se todas categorias

- *Corpus ID:* 4476
- *Score:* 0.8446866869926453
- *URL:* oculto
- *Início:* 00:44:29
- *Fim:* 00:47:08
- *Transcrição:* aqui e o somatório né dá o total ali de todas as ações Ok dúvida no soft Max deixa eu ver se mãos levantadas ã ok Por enquanto né Mas podem abrir o microfone aí qualquer coisa pra gente não não parar aqui tá Então esse assim que a gente faz o cálculo né da política soft Max aqui do agente e aqui nesse caso específico né calculando os potenciais ó vamos lá né o o a preferência né no caso aqui ainda ainda não é o potencial lá do soft Max não o potencial é o e elevado a isso aqui né Mas vamos lá ã então o pração de pra esquerda né deu 0 x 0 + 0 x 0 - 5 x 1 0 0 0 - 5 x 1 aqui na verdade deu -10 ó Men 10 tá errado aqui ó é - 10 corrigir aqui O slide correção ao vivo aqui ó menos 10 eu acho que tá todos errados né então vamos vamos corrigir aqui ó 0 x 0 0 3.5 0 0 0 0 0 deu 3.5 3.5 tá E aqui também qu né vez 0 ah tá acho que isso aqui aconteceu tá esses números foram calculados em outro estado aqui ó o estado que tinha outra representação aí na hora que eu fui botei esse aqui eu esqueci de atualizar os números então tô atualizando agora então 4 x 1 0 0 tudo zero aqui né zer então aqui deu 4 aqui deu 3,5 aqui deu 4 e o último aqui deu -1 + 10 deu 9 deu nove tá E aí a gente calcula tem que calcular o soft Max com base nesses valores aqui deixa eu ver como fazer para não tomar muito tempo eu não vou fazer isso agora tá mas aí a aí a política né seria soft Max em cima disso aqui fazer um soft Max em cima disso soft Max tá

- *Corpus ID:* 7741
- *Score:* 0.8444395661354065
- *URL:* oculto
- *Início:* 00:20:32
- *Fim:* 00:23:03
- *Transcrição:* entender a a função de ativação com a natureza dos dados que eu quero produzir tá então eh basicamente a a camada final final mesmo é essa tá mas existe uma camada anterior que é uma camada fully connected tá que bas basicamente ela gera 84 neurônios intermediários antes dos 10 de saída tá se eu voltar um pouquinho atrás e olhar a vgg olhar a a o alexnet a gente tinha duas camadas ocultas por exemplo com 4.096 neurônios tá então a pergunta é Car Quantas camadas ocultas eu coloco Qual é o tamanho dessas camadas ocultas e a resposta é sei lá tá o que é óbvio nesse problema é que a última camada vai ter 10 neurônios porque eu tenho 10 categorias e que a saída tem uma ativação soft Max Quantas camadas intermediárias full connected eu vou colocar E qual é o tamanho número de neurônios de cada uma delas é de novo é um pouco de experimentação feeling mas não existe um regra matemática que me permita setar isso aí tá então o importante é que a soma dos valores é sempre igual a um numa ativação softmax tá que é exatamente ah essa ideia de gerar uma distribuição de probabilidade então no final das contas como é que eu descubro Qual é a categoria vencedora é aquela cujo neurônio gerou maior score certo e aí existe uma função chamada argmax é uma função matemática e tem tanto no nump quanto no tensor Flow que ela exatamente me retorna dado um vetor por exemplo ele me retorna Qual é o elemento deste vetor que retornou o maior valor tá então o Max de um vetor é o valor máximo o arg Max é a posição onde esse valor máximo foi atingido tá então como eu tô interessado na posição né que é exatamente qual é o neurônio que gerou o máximo a gente usa essa de saída argmax para isso

- *Corpus ID:* 4492
- *Score:* 0.8443424105644226
- *URL:* oculto
- *Início:* 01:14:55
- *Fim:* 01:17:14
- *Transcrição:* gradiente nos dá essa informação Beleza então se eu aumentar aqui o teta nesse caso aqui ó se aumentar o teta então a probabilidade de a diminui deixa eu ver se aí um texto ali uma pergunta então a vantagem de soft Max é essa de encontrar o ponto da derivada é uma das vantagens tá o soft Max é diferenciável né uma função que tem derivada então e para para fins de calcular Gradiente né a gente precisa ter uma função com essas características e aqui no caso a gente tá num bom né num bom momento aqui se por acaso se eu se eu diminuo teta a probabilidade da ação aumenta né se eu mover aqui para esse lado aqui né vai ter mais chance de escolher ação a Ok então a gente sabe o que fazer né para aumentar a chance de escolher a ação mas eu preciso saber se a ação a é boa ou ruim né Eu preciso saber se eu tenho que aumentar ou diminuir a ação né só agora eu sei o que que eu preciso fazer mas agora eu preciso quer dizer eu sei como fazer né como que eu aumento ou diminuo a probabilidade de escolher aquela ação mas agora eu preciso saber exatamente o que fazer devo aumentar ou devo diminuir e o que vai nos dizer isso ó é né se eu mexer no Gradiente do desempenho né o gradiente do desempenho cada política né Cada probabilidade de escolher aquela ação vai me dar um desempenho então se eu tiver mesmo que eu não conheça qual é a função aqui né pode ser uma função bem maluca lá pode ser uma função bem bem digamos comportada ou não né uma função mais eh digamos complicada mas se eu tiver essa informação aqui da derivada já me diz que que eu tenho que fazer com aquela ação diga saiu uma uma dúvida ali não sei se pode falar hã então só recapitulando né Cada política cada chance de escolher aquela

- *Corpus ID:* 6767
- *Score:* 0.843654215335846
- *URL:* oculto
- *Início:* 01:13:19
- *Fim:* 01:15:22
- *Transcrição:* Max o soft Max embora ele ele vai ele vai gerar assim na aquelas 10 classes de saída lá que a gente tem ele vai gerar uma das saídas um dos dos neurônios vai ser o mais estimulado né e os outros vão ser zero mas nunca é zer zer zer ou um sempre tem uma pequena variação Então o que eu tô fazendo aqui tô simplesmente chamando round nessa Matriz para arredondar pra gente poder ver o zero e ver o um tá caso contrário a gente veria assim uma coisa não não um exato né então Eh depois de ter feito isso né a gente pode [Música] eh A partir dessa informação né a gente pode então calcular eh qual é a classe Qual é a categoria daquela daquela imagem em cima então isso a gente pode fazer por exemplo através dessa função argmax que ela vai pegar qual é a posição onde é que tá Aquela aquele valor máximo né então a gente vai fazer o predict que nem a gente fez e a gente faz um Max eh usando o eixo menos um aqui isso vai fazer com que a gente obtenha Qual que é a posição que tem o maior valor ali naquela de cada uma daquelas linhas ali Ok então a gente consegue ver que a primeira imagem é nove a segunda imagem é dois e a terceira imagem é um E aí a partir disso a gente consegue pegar esse pequeno Array que é o y pred e fornecer ele paraas nomes de classes aqui né E aí a gente consegue ver que é uma bota um moletom e uma calça a gente consegue gerar então isso aqui tudo estaria digamos assim naquele dispositivo né que tem pouco recurso que não foi usado para treinar é usado somente para fazer inferência assumindo claro que esse modelo aqui né seja pequeno o suficiente para caber no dispositivo né aí a gente consegue fazer low e fazer predict né notem que esse predict ele pode ser bem Custoso também se o meu modelo for muito grande né se a minha entrada for muito grande

- *Corpus ID:* 4399
- *Score:* 0.842960000038147
- *URL:* oculto
- *Início:* 00:16:33
- *Fim:* 00:18:46
- *Transcrição:* eu tô considerando E aí tem o exponencial aqui né o e elevado ao termo aqui porque para acentuar as diferenças né no soft Max tem essa característica né Se o se duas ações têm um valor muito próximo se o valor q das duas ações S muito próximo acaba que a ação que é um pouquinho melhor fica com uma fatia maior tá tipo sei lá se a diferença né foi foi tipo 0 ponto uma ação tiver o valor q de 1 outra tiver o valor q de do né a proporção aqui fica meio sei lá 70% para ação melhor né 0.7 aqui para ação melhor 30% para outra ação né que tem só um um de diferença aqui eu não não sei exatamente se seria o caso tá não fiz os números aqui mas a ideia do soft Max é acentuar as diferenças para favorecer né ação que tem o maior valor que torná-la né a mais ã com maior chance de ser escolhido e aqui no final né o o esse termo para normalizar Ou seja é É certo que né Se eu fizer isso para todas as ações o somatório delas vai dar um e é esse somatório que tá aqui embaixo né o o da fração aqui então o somatório do potencial de todas as ações e aí eu pego o potencial da ação que eu quero considerar e divido por esse somatório Então vou obter uma probabilidade e se eu somar todas as probabilidades É certo que vai dar um né porque é como se fosse somar todos os numeradores né somar todos os numeradores vou ter o somatório e esse somatório é o mesmo que tá aqui no denominador tá ã eu introduzi aqui a política soft Max né ela não não é mais não é aquilo que o learning executa na maioria das vezes Tá mas ela vai ser importante tem outros algoritmos aqui que usam né a ideia do soft Max Tá mas a ideia então é H as duas formas né de fazer na explora então se você tiver no seu dilema lá da de de escolher o salgadinho que você já sabe que é bom né o preferido e um outro novo joga uma moeda né define né se ou então usa né o cronômetro do relógio lá de acordo com o cronômetro dos


**Resposta gerada pelo LLM**: A função softmax gera um conjunto de valores entre 0 e 1, cuja soma é sempre igual a 1.  Ela é usada em problemas de classificação para indicar a probabilidade relacionada a cada saída, podendo ser vista como uma função de probabilidade.  Em redes neurais, é frequentemente usada na camada de saída para problemas de classificação multiclasse, normalizando as saídas de forma que a soma das probabilidades seja 100%.  A softmax é diferenciável, o que a torna adequada para o cálculo de gradientes em algoritmos de otimização.  Uma das vantagens do softmax é acentuar as diferenças entre valores próximos, favorecendo a escolha da ação com maior valor.

**Referências**:
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()

**Anotação manual**: C

**Answer Relevance (AR)**: 1.00

**Anotação automatizada**: C

**Raciocínio (AR CoT)**: Criteria: The RESPONSE must be relevant to the entire PROMPT to receive a maximum score of 3. It should provide a complete and accurate explanation of the softmax function. Supporting Evidence: The RESPONSE accurately defines the softmax function, explaining its purpose in generating probabilities that sum to 1, its application in classification problems, particularly in neural networks, and its differentiable nature which is important for optimization. It also mentions the advantage of softmax in emphasizing differences between values, which is relevant to its use in machine learning. This comprehensive explanation addresses all aspects of the PROMPT effectively.  Score: 3


---
