**Pergunta 102**: O que é o EarlyStopping e como ele funciona?

**Segmentos recuperados pelo E5**:
- *Corpus ID:* 4402
- *Score:* 0.8442935347557068
- *URL:* oculto
- *Início:* 00:21:27
- *Fim:* 00:23:54
- *Transcrição:* critério de par uma combinação das Duas né sempre bom ter um número máximo de Passos aqui né e enquanto isso né Igual no em redes neurais lá tem aqueles tem como mandar né o treinamento ser interrompido antes né o early stopping Então posso definir aqui uma parada prematura né se eu ver que o aprendizado já não tá né o ag gente tá meio que estagnado ali não tá mudando os valores tá então aqui né Essa comentári sobre o critério de parada do que learning e o dilema exploração exploitatie ter né uma probabilidade de explorar isso é necessário para aprender os valores das ações né e isso faz o que o learning funcionar tá tudo bem tem uma condição meio forte aqui né mas eu vou eh comentar ela eh mas o que o lan funciona se a gente mantém né um agente explorando né e hã cada ação é executada né Em cada estado no caso aqui para convergir matematicamente tem que ser tá até em redes neurais é assim também tá então número infinito de atualizações e a taxa de aprendizado decai apropriadamente né os valores inicializados arbitrariamente convergem para os verdadeiros com 100% de probabilidade né probabilidade um quer dizer 100% então esse é o teorema aqui do da convergência do q tá hã e o que que acontece né Igual aqui eu executei só por 10 Episódios e certamente né esses valores não são os corretos aqui né não convergiu ainda então eu vou retomar aquela ideia de executar em background lá por sei lá 1000 Episodes 1000 aqui ó em background menos q aqui aí dier rodou 1000 episódios lá e chegou nessa política chegou nessa política aqui é o nesses valores tá nesses valores que e eu não não sei exatamente se eles são os valores corretos ainda né mas o que dá para ver aqui ó que a partir do Estado Inicial né ele tem uma política correta aqui para para conseguir chegar né no aliás ainda fal não tá correta

- *Corpus ID:* 5419
- *Score:* 0.8426033854484558
- *URL:* oculto
- *Início:* 00:21:07
- *Fim:* 00:23:20
- *Transcrição:* Ou vocês consomem bastante recurso não sobra recurso tipo assim como é uma é uma plataforma de ensino né então o uso e e de pesquisa né ensino e Pesquisa o uso ele é esporádico entendeu então por exemplo o orientando de um um doutorando né tá tá com deadline para um artigo lá el tá fazendo experimentos pro seu artigo lá e o deadline daqui três semanas é agora que ele vai fazer um monte de experimento em geral a gente observa esse comportamento entendeu E aí depois que passa esses deadlines né Sempre tem deadline mas tipo acontece um uma falta de uso da máquina Então a gente tem estatísticas né que demonstram que a gente tem ciclo sobrando digamos assim né então a gente até instalou um sistema de de desligamento das máquinas para poupar energia né né então quando a máquina ela fica sei lá uma hora ali a gente tem um script que coloca ela em suspende E aí a gente economiza um horror de energia com isso aí né claro que não é uma preocupação absurda né porque enfim a gente tá aqui na urgs enfim mas mas mas é interessante ter essa preocupação assim até para preservar as máquinas enfim porque é uma plataforma que só para deixar ligada custou M entendeu h mais perguntas vamos lá Bruno pode falar em relação a dap vocês usam eh o pem dap ou vocês utilizam activ Direct openl dap é tudo feito com ferramentas e open source então a gente usa uma interface do PHP admin lá para gerenciar a base idap né então isso é por exemplo o administrador né que sou eu e mais alguns alunos aí voluntários a gente eh a gente configura todo o ldap via essa interface web né idap Garten pode falar Oi professor bom dia é o professor falou sobre sobre a pilha de software né para controlar isso a gente vai ver alguma coisa ou nem que seja como curiosidade durante o curso não não tenho a intenção de de de de focar nisso viu até porque mais nosso curso é mais

- *Corpus ID:* 6806
- *Score:* 0.8418281674385071
- *URL:* oculto
- *Início:* 00:38:55
- *Fim:* 00:40:59
- *Transcrição:* tolerância desfeita Alexandre marqu pode falar Prof Professor eh na sua experiência tem observado muita diferença do tempo inserindo aí esse callback no no treinamento não se se assim se tu usa esse tipo de callback quando tu tiver fazendo o treinamento tu vai chegar uma hora lá não sei se a gente pode até testar o pode testar esse early stopping eu não tinha pensado em testá-lo né mas chega na aula anterior por exemplo vocês viram que que a acurácia chega uma hora que ela não começa mais a evoluir ela fica ali subindo e descendo em volta do mesmo valor né então se tu colocasse um World Stop certamente tu tu economizaria tempo né Por exemplo tu pediu 100 épocas se a partir da 30ª época tu começa já nesse sob desce o World Stop Vai parar Então o teu ganho o teu ganho vai ser Evidente entendeu então mas aí a pergunta é a seguinte vamos lá 30 épocas Ele estacionou estacionou se para chegar nessas 30 épocas sem o callback ele ele ele demorou 5 minutos e se eu inserir um callback sei lá da forma que el ele passar 20 30 Isso entendi o custo do callback entendi Olha eu eu acredito que assim da nossa experiência com o trabalho da Ana né o trabalho da Ana a gente o o callback que a gente criou pegava Realmente instrumenta todos os métodos disponíveis entendeu Tipo epoc end epoc start é bem é bem grande a lista entendeu E a gente não prof uma diferença de tempo o custo disso entendeu E olha que a gente tava ainda fazendo né gravando em arquivo e tudo mais claro a gente tava usando uma biblioteca de rastreamento né a gente eh guardava tudo em memória para só depois para diminuir a intrusão toda aquela preocupação clássica de rastreamento né E a gente não percebeu um custo eh muito grande digamos assim entendeu Tipo ele existe né mas comparado com o tempo do treinamento ele era bem pequeno entendeu a ponto da gente nem nem se preocupar pá

- *Corpus ID:* 6804
- *Score:* 0.839759349822998
- *URL:* oculto
- *Início:* 00:35:49
- *Fim:* 00:37:54
- *Transcrição:* Então vou já vamos avançar aqui então então por exemplo se a gente quiser fazer uma parada antecipada daí tem um callback já existente para isso que acho que eu Recomendo vocês usarem que é o early stopping Então se a gente abrir a documentação dele ó olha só que interessante Ó tem uma série de parâmetros o parâmetro principal que a gente tem que definir são dois é o modo e o monitor OK são esses dois são os mais importantes o que que isso significa significa que o monitor o monitor Seria tipo assim qual é a métrica que eu estou observando entendeu é essa métrica aí que eu vou ã ficar de olho nela se ela não poir eu vou parar entendeu então esse é o monitor então tipo tu pode botar ali por exemplo loss aí tu vai ficar monitorando a perda Ok e o modo o modo Daí depende assim da métrica que tu escolheu né então por exemplo o loss tu quer que ele seja o mínimo possível né então o modo tu vai especificar Mind se tu deixar alto ele tem uma certa inteligência porque ele sabe que a palavra L né aí tu tu quer que H seja o modo mínimo ele automaticamente vai definir mínimo mas a acurácia por exemplo acurácia se tu for usar accuracy o modo vai ter que ser Max né Porque tu quer maximizar a acurácia né então ã Isso aí são dois parâmetros Então se tu não especificar nada vai ser a a perda da validação então a gente abrevia assim validation loss ele tem essas Strings que são suportadas notem que isso aqui é só uma string né então assim não é qualquer string né Eh são Strings significativas que ele tem eh eles botaram esse suporte para simplificar mas a pessoa pode ao invés de especificar a string ela pode especificar também eh qual é a classe que representa a validation loss Ok então isso daí a gente faz com a classe Talvez seja mais mais robusto assim tem outros parâmetros também que são bem interessantes eh por exemplo min

- *Corpus ID:* 6810
- *Score:* 0.8374986052513123
- *URL:* oculto
- *Início:* 00:45:01
- *Fim:* 00:47:27
- *Transcrição:* tem ele restaura e começa a treinar partir dali Ok então esse aqui é um ã um bem útil da gente empregar também depois tem eh essa documentação aqui tem aqui qual que é a frequência dá pra gente salvar mais frequentemente também se a gente quer deletar o checkpoint se a gente quer salvar before preemption esse aqui é especialmente útil é naqueles sistemas que a avisam que o nosso o nosso Fit vai morrer né então ele avisa antes da preempção então isso aqui não é qualquer sistema aqui na documentação ele comenta né que ele funciona Deixa eu só achar aqui a documentação exatamente onde é que tá ess isso aí tá aqui ó então ã o exatamente o save before preemption Tu tem uma certa situação para poder usar ele eh quando tu tá usando o o Google Cloud platform ou Google borg e tu tiver usando fazendo o treinamento distribuído com esse esse método aqui que é o multiwork mirrored strategy que a gente vai abordar nas aulas subsequentes na semana que vem ok então se tiver usando esse multiwork mirrored strategy no Google Cloud ou no Google borg se tu pode usar o save before preemption que daí antes de matar o processo esse sistema o Fit esse callback de que vai El ele tu vai morrer e aí ele po tem uma oportunidade para salvar o modelo antes de morrer Ok funciona só uma coisa específica do Google a pode falar jancar ele tem suporte a salvar o arquivo em outro repositório de objetos ao invés de F System tipo passar o RL de um s3 entendi olha aqui backup né Então eu não sei deixa eu dar uma olhada aqui ã é aqui ele usa o exemplo do file System normal é aqui não fala nada seria de testar viu jancarlo realmente não sei aqui não não diz nada tudo bem é ã buen Então acho que era isso eh sobre essa parte tá eh então assim tem essa apid do callbacks mais completa aqui ã onde tem todos os callbacks disponíveis estão vendo aqui ó tem alguns que a gente não

- *Corpus ID:* 6805
- *Score:* 0.8373087048530579
- *URL:* oculto
- *Início:* 00:37:21
- *Fim:* 00:39:27
- *Transcrição:* só uma string né então assim não é qualquer string né Eh são Strings significativas que ele tem eh eles botaram esse suporte para simplificar mas a pessoa pode ao invés de especificar a string ela pode especificar também eh qual é a classe que representa a validation loss Ok então isso daí a gente faz com a classe Talvez seja mais mais robusto assim tem outros parâmetros também que são bem interessantes eh por exemplo min Delta que tá definido por default para zero né mas min Delta permite a gente controlar assim ah qual que é o Delta que a gente Ace que a gente considera que mudança né a a partir desse Delta que é a diferença né entre dois valores né a gente CONSEG ah mudou se for menor do que esse Delta Não isso não isso não a gente não aceita como uma mudança né a gente pode considerar que é a mesma coisa e a paciência olha só que interessante esse nome né ela ela é quanto tempo tu espera né tipo assim se as coisas não estão mudando quanto tempo não estão mais evoluindo quanto quantas épocas tu espera para talvez começar a mudar de novo entendeu E aí se então seria quantas épocas tu tolera de não mudança para daí tu realmente parar entendeu então aqui é paciência é zero definido por Def quer dizer que assim na hora que não mudou assim tipo entre duas épocas as coisas não mudaram de acordo com o min Delta modo e monitor ele já vai parar entendeu Mas tu pode ter uma tolerância desfeita Alexandre marqu pode falar Prof Professor eh na sua experiência tem observado muita diferença do tempo inserindo aí esse callback no no treinamento não se se assim se tu usa esse tipo de callback quando tu tiver fazendo o treinamento tu vai chegar uma hora lá não sei se a gente pode até testar o pode testar esse early stopping eu não tinha pensado em testá-lo né mas chega na aula anterior por exemplo

- *Corpus ID:* 1915
- *Score:* 0.8356162905693054
- *URL:* oculto
- *Início:* 01:25:21
- *Fim:* 01:27:18
- *Transcrição:* tá muitas vezes ela pode chegar um resultado bom assim bastante competitivo com pós poda o que pode acontecer é que essa esse orlestoping que é o que acontece com pré-poda tem essa desvantagem de ser o que a gente chama de uma estratégia gulosa porque Eu determino Essa é minha profundidade máxima por exemplo e eu e eu ignoro o fato de que depois daquela profundidade podem surgir algumas partições que podem melhorar eventualmente o desempenho Ou seja a profundidade máxima ela se ela for muito profunda ela pode piorar muito mas algo intermediário Pode ser que melhore um pouco meu desempenho e me dê regras mais específicas para alguns casos tá então Como tudo tem vantagens e desvantagem né o treinamento ele costuma ser mais rápido mas tem essa questão da gente ignorar o fato de que por exemplo depois de uma profundidade máxima de três na profundidade máxima de quatro poderiam surge coisas que até melhor o desempenho em relação a de três por isso que na prática o que a gente tem que fazer um processo de otimização de parâmetros a gente não tem muito como fugir disso tá de qual é o melhor critério de propósito após pó ela pode ser lenta quando tem um conjunto de dados grandes muitas instâncias muitos atributos mas ela tem de ser mais efetiva nesse equilíbrio entre complexidade e desempenho né o custo né aqui o desempenho estava chamando antes de custo né que é o próprio algoritmo custo complexidade porque o critério do algoritmo né o algoritmo que era um equilíbrio e aí a gente vai mudando o alfa para ver o quanto que a gente tá pesando a complexidade para reduzir mais a complexidade mas o algoritmo é guiado por esse equilíbrio então é natural que ele tenha um resultado melhor em termos desse equilíbrio certo porque é basicamente é o que nos orienta no algoritmo de custo complexidade

- *Corpus ID:* 6797
- *Score:* 0.8341869711875916
- *URL:* oculto
- *Início:* 00:25:25
- *Fim:* 00:27:19
- *Transcrição:* internamente Talvez esteja implementado com como se fosse um callback né mas não é um callback do usuário né ali já seria o comportamento padrão é só o fato de estar verbose né né então o callback ele vai um pouco além disso porque o esses callbacks do usuário tu pode realmente salvar aquelas informações entendeu tipo assim colocar num log entendeu ou já eh disparar um processo que vai criar um gráfico esse gráfico vai se atualizar na medida que vai vai acontecendo os treinamentos Entendeu Como se tu tivesse por exemplo telas de acompanha acanhamento né tu lança o treinamento imagina leva semanas né as pessoas querem ficar olhando se tem algum ind algum dos treinamentos indo bem aí tu faz ess tipo de então é para fazer coisas mais sofisticadas do que simplesmente ver aquelas informações textuais na tela né que não tem como tu salvar né Eh até bom até tem como salvar né tu vai ter esse log né Mas tu redirecionar a saída né para um arquivo né mas é uma coisa bem muito muito simples daí no caso né comparado com callback né então assim aqui nesse exemplo a gente tá usando uma uma uma classe certo essa classe já existe ela tem um propósito que é fazer o Model checkpoint Mas a gente pode customizar com as nossas próprias funções então por exemplo a gente pode instanciar essa classe meu callback aqui né que ela erda de callback do que eras E aí dentro dessa Classe A gente vai ter uma série de métodos que a gente pode sobrescrever e esses métodos são os métodos que efetivamente vão acontecer tem determinados momentos né tipo assim os métodos eles são pré pré listados eles pré existem né A gente só vai sobrescrever Aqueles que a gente deseja né então um que é bastante interessante de sobrescrever É esse aqui que se chama on epoc end que significa assim que no final de uma época ele vai lançar esse método ele vai invocar esse método se

- *Corpus ID:* 6714
- *Score:* 0.8341599106788635
- *URL:* oculto
- *Início:* 01:01:27
- *Fim:* 01:03:24
- *Transcrição:* próxima aula dentre as quais o tensor board então a gente consegue ver durante a execução durante a execução do treinamento durante o Fit a gente consegue ver os valores de accuracy de de Loss vendo como é que eles estão evoluindo pra gente perceber o quanto antes se a nossa ideia de modelo tava errada entendeu assim tipo ah a cur não tá não tá melhorando tô treido treido treido não tá melhorando faz se lá faz duas épocas que eu que não aumenta o accuracy se não aumenta o accuracy tem um problema entendeu E aí tu já pode abortar entendeu então tem uma série de eh callbacks que a gente pode usar para inclusive automatizar esse processo tá então a gente vai falar sobre Model checkpoint eh enfim early stopping que é esse que a gente vai comentar na próxima aula que é assim se as coisas não estiverem indo bem a gente já para entendeu porque é é é cálculo jogado fora entendeu então eh durante o feit que a gente vai acompanhar então e as como é que as coisas estão andando tá tá ok Car tá Seria tipo um parâmetro ali no no fit né tipo pare se a acurácia não tiver aumentando isso a gente vai especificar Então os callbacks eh ou através de parâmetros ou através ou através de uma pré-configuração e a gente passa essa pré-configuração pro Fit e aí o Fit ele vai por exemplo quando começar uma época por exemplo ele pode quando terminar uma época ele pode fazer um cálculo ali eh verificar o accuracy e comparar com o que a gente quer que ele seja ou a tendência que a gente quer que seja entendeu e se não for ele para porque muito dos estudos né Isso tu pega aqui eh por exemplo aqui eu tenho um monte de colega aqui que tá trabalhando com bom quem não está trabalhando com Prade profunda mas a gente vê eles usando os alunos né usando o pcad ali né onde eles ficam testando um monte de modelo entendeu fica variando esse modelo aqui de uma maneira

- *Corpus ID:* 7131
- *Score:* 0.8334077000617981
- *URL:* oculto
- *Início:* 00:19:57
- *Fim:* 00:22:14
- *Transcrição:* Eh quem já brincou um pouquinho mais com colab deve ter percebido que ele tem aquelas ah aquelas desconexões né que acontecem Então se tu tá treido um modelo ele deixa tu tem que ficar toda a hora meio que eh dizendo estou aqui né para para ele não cancelar tua tua conexão e mesmo assim depois de um um certo período ele ele mata a conexão então A ideia é eh para burlar esse tipo de situação né A ideia é fazer uma espécie de de salvamento né de armazenamento dos pesos de um modelo de tempos em tempos para que a gente possa voltar a um determinado checkpoint né e seguir o treinamento a partir dali pra gente evitar esse tipo de de situação aqui né ainda usando essa ferramenta aberta do colab eh a gente vai acabar trabalhando na grande maioria das vezes com modelos prét treinados tá então A ideia é que a gente vai entender como é que faria o tre zero né mas mas o uso de modelo pré-treino vai ser vai ser fomentado aqui né por essa questão e por outras também né Assim como eh o próprio tempo de de treinamento para uma determinada tesque a gente poderia reduzir simplesmente usando modelos pré treinados tá e o teams que a gente já tá usando agora com relação ao cronograma pessoal h tá aqui tá eu acredito que esteja aqui em cima também é isso cronograma previsto deve apontar pro mesmo link eh Então é só para para ter uma ideia né Eu acho que as primeiras três quatro aulas as primeiras quatro aulas elas TM uma cara de de processamento de imagens tá e as quatro últimas aulas Elas têm uma cara bem forte de visão computacional tá então eh a gente vai daqui a pouquinho entender onde é que que cada uma das áreas eh contribui Tá mas é mas é basicamente isso a gente tentou dividir a disciplina de acordo com eh o tempo que a gente tem né para trazer para vocês o que a gente


**Resposta gerada pelo LLM**: EarlyStopping é um callback que interrompe o treinamento antecipadamente se uma métrica observada (como loss ou accuracy) parar de melhorar.  Ele monitora uma métrica específica (definida pelo parâmetro "monitor") e, dependendo do modo (min ou max), para o treinamento se a métrica não melhorar por um determinado número de épocas (definido pelo parâmetro "patience").  O parâmetro "min_delta" define a menor mudança na métrica considerada significativa.

**Referências**:
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()
- [Vídeo de referência oculto]()

**Anotação manual**: C

**Answer Relevance (AR)**: 1.00

**Anotação automatizada**: C

**Raciocínio (AR CoT)**: Criteria: The RESPONSE must be relevant to the entire PROMPT to receive a maximum score of 3. Supporting Evidence: The RESPONSE accurately defines EarlyStopping and explains how it functions, addressing both parts of the PROMPT. It describes the purpose of EarlyStopping, the metrics it monitors, and the parameters involved in its operation, which directly relates to the question asked.  Score: 3


---
